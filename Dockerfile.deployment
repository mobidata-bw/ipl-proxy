FROM python:3.11-alpine

WORKDIR /app

EXPOSE 8080

RUN adduser -S -D mitm && chown mitm /app
USER mitm

COPY addons.py ./addons.py

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY app ./app

CMD ["mitmdump", "-s", "addons.py"]
